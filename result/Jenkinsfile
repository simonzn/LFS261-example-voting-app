pipeline {
    agent any
    tools {
      nodejs 'nodejs 22.4.0'
    }
    stages{
        stage('build'){
            when {
              changeset '**/result/**'
            }
            steps{
                echo 'building result app'
                dir('result'){
                  sh 'npm install'
                }
            }
        }
        stage('test'){
            when {
              changeset '**/result/**'
            }
            steps{
                echo 'running unit tests on result app'
                dir('result'){
                  sh 'npm test'
                }
            }
        }
    }
    post{
      always{
        echo 'the job is complete'
      }
      failure{
        slackSend (channel: "#lfs261", message: "Build Failed: ${env.JOB_NAME} ${env.BUILD_NUMBER}")
      }
      success{
        slackSend (channel: "#ci-cd", message: "Build Success: ${env.JOB_NAME} ${env.BUILD_NUMBER}")
      }
    }
}
